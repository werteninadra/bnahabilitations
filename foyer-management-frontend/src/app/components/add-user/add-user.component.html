<form [formGroup]="userForm" (ngSubmit)="onSubmit()">

  <div class="form-group">
    <label for="matricule">Matricule</label>
    <input
      id="matricule"
      type="text"
      formControlName="matricule"
      class="form-control"
      [class.is-invalid]="userForm.get('matricule')?.invalid && userForm.get('matricule')?.touched"
      placeholder="Ex: 03123456789012345678"
    />
    <div *ngIf="userForm.get('matricule')?.invalid && userForm.get('matricule')?.touched" class="invalid-feedback">
      <small *ngIf="userForm.get('matricule')?.errors?.['required']">Le matricule est requis.</small>
      <small *ngIf="userForm.get('matricule')?.errors?.['pattern']">Format matricule invalide.</small>
    </div>
  </div>

  <div class="form-group">
    <label for="nom">Nom</label>
    <input
      id="nom"
      type="text"
      formControlName="nom"
      class="form-control"
      [class.is-invalid]="userForm.get('nom')?.invalid && userForm.get('nom')?.touched"
    />
    <div *ngIf="userForm.get('nom')?.invalid && userForm.get('nom')?.touched" class="invalid-feedback">
      <small>Le nom est requis.</small>
    </div>
  </div>

  <div class="form-group">
    <label for="prenom">Prénom</label>
    <input
      id="prenom"
      type="text"
      formControlName="prenom"
      class="form-control"
      [class.is-invalid]="userForm.get('prenom')?.invalid && userForm.get('prenom')?.touched"
    />
    <div *ngIf="userForm.get('prenom')?.invalid && userForm.get('prenom')?.touched" class="invalid-feedback">
      <small>Le prénom est requis.</small>
    </div>
  </div>

  <div class="form-group">
    <label for="telephone">Téléphone</label>
    <input
      id="telephone"
      type="text"
      formControlName="telephone"
      class="form-control"
      [class.is-invalid]="userForm.get('telephone')?.invalid && userForm.get('telephone')?.touched"
    />
    <div *ngIf="userForm.get('telephone')?.invalid && userForm.get('telephone')?.touched" class="invalid-feedback">
      <small>Le téléphone est requis.</small>
    </div>
  </div>

  <div class="form-group">
    <label for="email">Email</label>
    <input
      id="email"
      type="email"
      formControlName="email"
      class="form-control"
      [class.is-invalid]="userForm.get('email')?.invalid && userForm.get('email')?.touched"
      placeholder="exemple@domaine.com"
    />
    <div *ngIf="userForm.get('email')?.invalid && userForm.get('email')?.touched" class="invalid-feedback">
      <small *ngIf="userForm.get('email')?.errors?.['required']">L'email est requis.</small>
      <small *ngIf="userForm.get('email')?.errors?.['email']">Format d'email invalide.</small>
    </div>
  </div>

  <div class="form-group">
    <label for="password">Mot de passe</label>
    <input
      id="password"
      type="password"
      formControlName="password"
      class="form-control"
      [class.is-invalid]="userForm.get('password')?.invalid && userForm.get('password')?.touched"
    />
    <div *ngIf="userForm.get('password')?.invalid && userForm.get('password')?.touched" class="invalid-feedback">
      <small>Le mot de passe est requis.</small>
    </div>
  </div>
<div class="form-group">
  <label for="agence">Agence</label>
  <select
    id="agence"
    formControlName="agenceId"
    class="form-control"
    [class.is-invalid]="userForm.get('agenceId')?.invalid && userForm.get('agenceId')?.touched"
  >
    <option value="">-- Sélectionner une agence --</option>
    <option *ngFor="let agence of agences" [value]="agence.id">
      {{ agence.nom }}
    </option>
  </select>
  <div *ngIf="userForm.get('agenceId')?.invalid && userForm.get('agenceId')?.touched" class="invalid-feedback">
    <small>Une agence est requise.</small>
  </div>
</div>


  <div class="form-group">
    <label for="profil">Profil</label>
    <select
      id="profil"
      formControlName="profil"
      class="form-control"
      [class.is-invalid]="userForm.get('profil')?.invalid && userForm.get('profil')?.touched"
    >
      <option value="">-- Sélectionner un profil --</option>
      <option *ngFor="let profil of profils" [value]="profil.nom">
        {{ profil.nom }} 
      </option>
    </select>
    <div *ngIf="userForm.get('profil')?.invalid && userForm.get('profil')?.touched" class="invalid-feedback">
      <small>Un profil est requis.</small>
    </div>
  </div>

  <div class="form-actions mt-3">
    <button type="submit" class="btn btn-primary" [disabled]="userForm.invalid">Ajouter Utilisateur</button>
    <button type="button" class="btn btn-secondary" (click)="goBack()">Annuler</button>
  </div>

</form>
