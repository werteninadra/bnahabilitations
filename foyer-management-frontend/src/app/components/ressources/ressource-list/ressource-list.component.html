
<app-navbar (search)="onSearch($event)"></app-navbar>

<div class="container mt-4">
  <h2>Liste des Ressources</h2>

  <!-- Graphique -->
  

  <button routerLink="/ressources/new" class="btn btn-primary mb-3">Ajouter une Ressource</button>

  <table class="table table-striped table-bordered" *ngIf="filteredRessources.length > 0; else noData">
    <thead>
      <tr>
         <th>Application</th>
        <th>Profils Assignés</th>
        <th>Code</th>
        <th>Libellé</th>
        <th>Type</th>
        <th>Statut</th>
         <th>Temps estimé (jours)</th> 
   
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let ressource of filteredRessources">
        
        <td>
          <span *ngIf="ressource.application">
            {{ ressource.application.code }} - {{ ressource.application.libelle }}
          </span>
          <span *ngIf="!ressource.application" class="text-muted">Aucune application</span>
        </td>
        <td>
          <div *ngIf="ressource.profils && ressource.profils.length > 0">
            <span *ngFor="let profil of ressource.profils" class="badge bg-secondary me-1">
              {{ profil.nom }}
            </span>
          </div>
          <div *ngIf="!ressource.profils || ressource.profils.length === 0">
            <span class="text-muted">Aucun profil</span>
          </div>
        </td>
        <td>{{ ressource.code }}</td>
        <td>{{ ressource.libelle }}</td>
        <td>{{ ressource.typeRessource }}</td>
        <td>
          <span [class.badge-success]="ressource.statut" [class.badge-danger]="!ressource.statut" class="badge">
            {{ ressource.statut ? 'Actif' : 'Inactif' }}
          </span>
        </td>
              <td>{{ ressource.tempsEstimeJours ?? '-' }}</td> <!-- Affichage temps estimé -->

        <td>
          <button [routerLink]="['/ressources', ressource.code, 'edit']" class="btn btn-sm btn-primary">
            <i class="bi bi-pencil"></i> Modifier
          </button>
          <button (click)="deleteRessource(ressource.code)" class="btn btn-sm btn-danger ms-2">
            <i class="bi bi-trash"></i> Supprimer
          </button>
          <button [routerLink]="['/ressources', ressource.code, 'assign']" class="btn btn-sm btn-info ms-2">
            <i class="bi bi-people"></i> Assigner
          </button>
        </td>
      </tr>
    </tbody>
  </table>
<div style="max-width: 1000px; margin-bottom: 2rem;">
    <canvas #appChart style="width: 50%; height: 300px;"></canvas>
  </div>
  <ng-template #noData>
    <div class="alert alert-warning">Aucune ressource trouvée.</div>
  </ng-template>
</div>
